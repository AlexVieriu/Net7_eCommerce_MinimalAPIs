@page "/login"

@inject IAuthentificationRepository authRepo
@inject NavigationManager navManager

<h3 class="my-5">Login Page</h3>

<div class="card p-4 d-flex justify-content-center col-8">
    <EditForm Model="LoginModel" OnValidSubmit="HandleLogin">
        <DataAnnotationsValidator />
        <ValidationSummary />

        <div class="pb-4">
            <label class="fw-bold">User Name</label>
            <InputText class="form-control" @bind-Value="LoginModel.UserName" />
        </div>

        <div class="pb-4">
            <label class="fw-bold">Password</label>
            <InputText class="form-control" @bind-Value="LoginModel.Password" type="password" />
        </div>
        <br />
        <button class="btn btn-primary" type="submit">
            Login User
        </button>
    </EditForm>
</div>

@code {
    User LoginModel = new();

    public async Task HandleLogin()
    {
        var isLogged = await authRepo.Login(LoginModel.UserName, LoginModel.Password);
        if (isLogged)
            navManager.NavigateTo("/");
    }
}
